# üö¢ AIS Track Analysis System

AIS(Automatic Identification System) Îç∞Ïù¥ÌÑ∞Î•º ÌôúÏö©Ìïú ÏÑ†Î∞ï Ï∂îÏ†Å Î∞è Î∂ÑÏÑù ÏãúÏä§ÌÖúÏûÖÎãàÎã§.  
CNN-LSTM, Ïò§Î¶¨ÏßÄÎÑê LSTM, VQ-LSTM, TCN Í∏∞Î∞ò ÏÑ†Î∞ï Î∂ÑÎ•òÏôÄ VAE Í∏∞Î∞ò Ïù¥ÏÉÅ ÌÉêÏßÄ Í∏∞Îä•ÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§.

---

# üö¢ AIS Track Analysis System (English Version)

AIS (Automatic Identification System) data-based vessel tracking and analysis system.  
Provides vessel classification based on CNN-LSTM, Original LSTM, VQ-LSTM, TCN, and anomaly detection using VAE.

## üìã Project Overview

### üéØ Key Features
- **Vessel Classification**: MMSI-based vessel identification using CNN-LSTM, Original LSTM, VQ-LSTM, TCN
- **Anomaly Detection**: Abnormal vessel behavior detection using VAE
- **Various Loss Functions**: Support for Cross Entropy, Triplet Loss, Contrastive Loss, Combined Loss
- **Visualization**: Confusion Matrix, t-SNE embeddings, reconstruction error distribution, etc.

### üèóÔ∏è Architecture
- **CNN-LSTM**: Learning spatial and temporal patterns from time-series AIS data
- **Original LSTM**: Pure LSTM-based time-series pattern learning
- **VQ-LSTM**: LSTM with Vector Quantization for more efficient embedding learning
- **VQ Bottleneck LSTM**: CNN-VQ-LSTM structure for information compression through semantic abstraction
- **Dual Stream LSTM**: Complementary feature learning by combining CNN-LSTM and VQ-LSTM
- **TCN (Temporal Convolutional Network)**: Time-series modeling based on dilated convolution
- **Dilated Residual TCN**: Improved TCN with Layer Normalization
- **Attention TCN**: TCN combined with Multi-head Attention
- **TCN-Transformer**: TCN + Transformer Hybrid model
- **Graph TCN**: TCN combined with Graph Convolution
- **MS-TCN-RF**: Multi-Scale TCN with Receptive Field Search (capturing both long and short-term patterns)
- **VAE (Variational AutoEncoder)**: Anomaly detection after learning normal patterns
- **Data Processing**: MinMaxScaler normalization, sequence generation

## üöÄ Installation and Execution

### 1. Environment Setup
```bash
# Create virtual environment
python -m venv ais_tracking_env

# Activate virtual environment (Windows)
.\ais_tracking_env\Scripts\Activate.ps1

# Activate virtual environment (Linux/Mac)
source ais_tracking_env/bin/activate

# Install dependencies
pip install -r requirements.txt
```

### 2. Execution Methods

#### Basic Execution (CNN-LSTM Classification)
```bash
python main_unified.py --csv_path your_data.csv
```

#### Classification with Different Models
```bash
# Original LSTM
python main_unified.py --model_type original_lstm --csv_path your_data.csv

# VQ-LSTM
python main_unified.py --model_type vq_lstm --csv_path your_data.csv

# VQ Bottleneck LSTM (CNN-VQ-LSTM)
python main_unified.py --model_type vq_bottleneck_lstm --csv_path your_data.csv

# Dual Stream LSTM (CNN-LSTM + VQ-LSTM)
python main_unified.py --model_type dual_stream_lstm --csv_path your_data.csv

# TCN (Basic)
python main_unified.py --model_type tcn --csv_path your_data.csv

# Dilated Residual TCN (Improved version)
python main_unified.py --model_type dilated_residual_tcn --csv_path your_data.csv

# Attention TCN
python main_unified.py --model_type attention_tcn --csv_path your_data.csv

# TCN-Transformer Hybrid
python main_unified.py --model_type tcn_transformer --csv_path your_data.csv

# Graph TCN
python main_unified.py --model_type graph_tcn --csv_path your_data.csv

# MS-TCN-RF (Multi-Scale TCN with Receptive Field Search)
python main_unified.py --model_type ms_tcn_rf --csv_path your_data.csv

# MS-TCN-RF Customization
python main_unified.py --model_type ms_tcn_rf --ms_use_delta_features --ms_use_deformable --ms_rf_branches "0.25,1,2,4" --csv_path your_data.csv
```

#### Using Various Loss Functions
```bash
# Cross Entropy (Default)
python main_unified.py --loss_type cross_entropy --csv_path your_data.csv

# Triplet Loss
python main_unified.py --loss_type triplet --triplet_margin 1.5 --csv_path your_data.csv

# Contrastive Loss
python main_unified.py --loss_type contrastive --contrastive_temperature 0.05 --csv_path your_data.csv

# Combined Loss (Cross Entropy + Triplet/Contrastive)
python main_unified.py --loss_type combined --combined_weight 0.7 --csv_path your_data.csv
```

#### VAE Anomaly Detection
```bash
python main_unified.py --mode anomaly --csv_path your_data.csv
```

#### Test Only Execution with Existing Checkpoints
```bash
python main_unified.py --test_only
```

## üìä Usage

### Command Line Options
```bash
python main_unified.py [OPTIONS]

Options:
  --mode {classification,anomaly}     Analysis mode (default: classification)
  --model_type {cnn_lstm,original_lstm,vq_lstm,vq_bottleneck_lstm,dual_stream_lstm,tcn,dilated_residual_tcn,attention_tcn,tcn_transformer,graph_tcn}  Model type (default: tcn)
  --csv_path PATH                     AIS data CSV file path
  --epochs INT                        Number of training epochs (default: 80)
  --beta FLOAT                        VAE KL loss weight (default: 0.1)
  --lr FLOAT                          Learning rate (default: 5e-3)
  --weight_decay FLOAT                Weight decay (default: 1e-4)
  --grad_clip FLOAT                   Gradient clipping value (default: 1.0)
  --label_smoothing FLOAT             Label smoothing for CE loss (default: 0.1)
  --scheduler_warmup_epochs INT       LR warmup epochs (default: 1)
  --min_lr_ratio FLOAT                Minimum learning rate ratio (default: 0.4)
  --restart_period INT                 cosine_restart period (default: 10)
  --loss_type {cross_entropy,triplet,contrastive,combined}  Loss function type (default: cross_entropy)
  --triplet_margin FLOAT              Triplet loss margin (default: 1.0)
  --contrastive_temperature FLOAT     Contrastive loss temperature (default: 0.07)
  --combined_weight FLOAT             Combined loss weight (default: 0.5)
  --device {auto,cuda,cpu}           Computing device selection (default: auto)
  --split_path PATH                   Split indices file path
  --test_only                         Run test only without training if checkpoints exist
```

### Examples
```bash
# CNN-LSTM Classification (Basic)
python main_unified.py --csv_path combined_output.csv --epochs 100

# Original LSTM Classification
python main_unified.py --model_type original_lstm --csv_path combined_output.csv

# TCN Classification (Basic)
python main_unified.py --model_type tcn --csv_path combined_output.csv

# Attention TCN + Triplet Loss
python main_unified.py --model_type attention_tcn --loss_type triplet --triplet_margin 1.5 --csv_path combined_output.csv

# TCN-Transformer + Contrastive Loss
python main_unified.py --model_type tcn_transformer --loss_type contrastive --contrastive_temperature 0.05 --csv_path combined_output.csv

# Dilated Residual TCN + Combined Loss
python main_unified.py --model_type dilated_residual_tcn --loss_type combined --combined_weight 0.7 --csv_path combined_output.csv

# VAE Anomaly Detection
python main_unified.py --mode anomaly --csv_path combined_output.csv --epochs 50

# Test only with saved model
python main_unified.py --test_only
```

## üìÅ Data Format

### Input CSV File Structure
```
MMSI,BaseDateTime,LAT,LON,SOG,COG,Heading,WDIR,WSPD,GST,PRES,ATMP,WTMP,...
```

### Required Columns
- **Classification Mode**: `LAT`, `LON`, `SOG`, `COG`, `Heading`
- **Anomaly Detection Mode**: `LAT`, `LON`, `SOG`, `COG`, `Heading`, `WDIR`, `WSPD`, `GST`, `PRES`, `ATMP`, `WTMP`

## üß† Model Description

### CNN-LSTM Classification Model
- **Purpose**: MMSI-based vessel classification
- **Input**: 5 features (latitude, longitude, speed, course, heading)
- **Structure**: CNN ‚Üí LSTM ‚Üí Classifier
- **Features**: Learning both spatial patterns and temporal dependencies

### Original LSTM Model
- **Purpose**: MMSI-based vessel classification
- **Input**: 5 features (latitude, longitude, speed, course, heading)
- **Structure**: LSTM ‚Üí Classifier
- **Features**: Pure LSTM for time-series pattern learning

### Dual Stream LSTM Model
- **Purpose**: MMSI-based vessel classification
- **Input**: 5 features (latitude, longitude, speed, course, heading)
- **Structure**: CNN-LSTM (Stream A) + VQ-LSTM (Stream B) ‚Üí Feature Fusion ‚Üí Classifier
- **Features**: Complementary learning of continuous dynamics and discrete semantics

### VAE Anomaly Detection Model
- **Purpose**: Abnormal vessel behavior detection
- **Input**: 11 features (including weather data)
- **Structure**: Encoder ‚Üí Latent Space ‚Üí Decoder
- **Principle**: Anomaly detection through reconstruction error after learning normal patterns

### TCN (Temporal Convolutional Network) Model
- **Purpose**: MMSI-based vessel classification
- **Input**: 5 features (latitude, longitude, speed, course, heading)
- **Structure**: Dilated Convolution ‚Üí Global Average Pooling ‚Üí Classifier
- **Features**: Parallel processing possible, efficient for long sequences

### Dilated Residual TCN Model
- **Purpose**: MMSI-based vessel classification
- **Input**: 5 features (latitude, longitude, speed, course, heading)
- **Structure**: Dilated Residual Blocks ‚Üí Global Average Pooling ‚Üí Classifier
- **Features**: Enhanced stability with Layer Normalization, deep network learning with residual connections

### Attention TCN Model
- **Purpose**: MMSI-based vessel classification
- **Input**: 5 features (latitude, longitude, speed, course, heading)
- **Structure**: TCN ‚Üí Multi-head Attention ‚Üí Global Average Pooling ‚Üí Classifier
- **Features**: Focusing on important time points for more accurate classification

### TCN-Transformer Hybrid Model
- **Purpose**: MMSI-based vessel classification
- **Input**: 5 features (latitude, longitude, speed, course, heading)
- **Structure**: TCN Encoder ‚Üí Transformer Encoder ‚Üí Global Average Pooling ‚Üí Classifier
- **Features**: Powerful model combining long-range dependencies and attention

### Graph TCN Model
- **Purpose**: MMSI-based vessel classification
- **Input**: 5 features (latitude, longitude, speed, course, heading)
- **Structure**: TCN ‚Üí Graph Convolution ‚Üí Classifier
- **Features**: More accurate classification by modeling relationships between vessels

### MS-TCN-RF (Multi-Scale TCN with Receptive Field Search) Model
- **Purpose**: MMSI-based vessel classification (capturing both long and short-term patterns)
- **Input**: 5 features (latitude, longitude, speed, course, heading) + Œîfeatures + time intervals
- **Structure**: 
  - **Multi-Scale RF Branches**: Parallel processing of different RFs (RF‚âà0.25√ó¬∑1√ó¬∑4√ó)
  - **Gating/Attention**: Learning optimal combinations through branch-wise weighted sums
  - **Œî-Feature Encoding**: COG/SOG absolute values + ŒîCOG, ŒîSOG, ŒîLat, ŒîLon, Œît
  - **Deformable Temporal Convolution**: Learning sample position offsets on the time axis
  - **Segment-Aware Pooling**: Statistics per segment (anchoring/acceleration/turning) + attention pooling
- **Features**: 
  - Robust dual-stream processing for irregular sampling
  - Alignment of vessel's irregular acceleration/deceleration/turning intervals
  - Behavior state-aware embedding

### Loss Functions
- **Cross Entropy**: Basic classification loss function
- **Triplet Loss**: Learning to bring same vessels closer and different vessels farther apart
- **Contrastive Loss**: Similarity-based learning for better embedding space generation
- **Combined Loss**: Combination of Cross Entropy and Triplet/Contrastive Loss

## üìà Output Results

### Classification Mode
- **Performance Metrics**: Accuracy, Precision, Recall, F1-score
- **Visualization**: 
  - Confusion Matrix (original/normalized)
  - t-SNE embedding space
- **Saved Files**: `checkpoints/{model_type}_classifier.pt`

### Anomaly Detection Mode
- **Performance Metrics**: Anomaly detection accuracy, threshold
- **Visualization**:
  - Reconstruction error histogram
  - Latent space t-SNE
- **Saved Files**: `checkpoints/vae_final.pt`

## üîß Key Files

### Core Files
- `main_unified.py`: Main execution file
- `cnn_lstm_model.py`: CNN-LSTM classification model
- `lstm_models.py`: Original LSTM, VQ-LSTM models
- `va_vae_model.py`: VAE anomaly detection model
- `requirements.txt`: Dependency package list

### Data Files
- `combined_output.csv`: AIS data
- `split_indices.pkl`: Data split indices

### Output Files
- `checkpoints/`: Trained model checkpoints
- `logs/`: Training logs
- `*.png`: Visualization results

## üéØ Model Operation Principles

### Core Ideas of MS-TCN-RF Model
1. **Multi-Scale RF Search**: Parallel processing of different receptive fields to capture both long and short-term patterns
2. **Œî-Feature Encoding**: Processing absolute values, changes, and time intervals as separate streams
3. **Deformable Temporal Convolution**: Learning sample position offsets on the time axis to align irregular patterns
4. **Segment-Aware Pooling**: Behavior state recognition for segment-wise statistics + attention pooling

### Classification Models
1. **Data Preprocessing**: Normalization with MinMaxScaler
2. **Sequence Generation**: Fixed-length sequences of 50 points
3. **Model-specific Processing**:
   - **CNN-LSTM**: CNN ‚Üí LSTM ‚Üí Classification
   - **Original LSTM**: LSTM ‚Üí Classification
   - **VQ-LSTM**: LSTM ‚Üí Vector Quantizer ‚Üí Classification
4. **Classification**: MMSI-based vessel prediction

### Anomaly Detection (VAE)
1. **Normal Pattern Learning**: Learning normal behavior with majority of data
2. **Reconstruction**: Input ‚Üí Latent Space ‚Üí Restoration
3. **Error Calculation**: Difference between input and restoration results
4. **Anomaly Detection**: Detected as anomaly when exceeding threshold (95%)

## üîç Model Comparison

| Model | Features | Advantages | Disadvantages |
|-------|----------|------------|---------------|
| **CNN-LSTM** | Spatial + Temporal patterns | Complex pattern learning | High parameter count |
| **TCN** | Dilated convolution | Parallel processing, long sequences | Limited local patterns |
| **Dilated Residual TCN** | LayerNorm + Residual | Stable learning, deep networks | Increased parameter count |
| **Attention TCN** | TCN + Attention | Focus on important time points | Increased computational complexity |
| **TCN-Transformer** | TCN + Transformer | Long-range dependencies | Very complex structure |
| **Graph TCN** | TCN + Graph Conv | Vessel relationship modeling | Graph structure required |
| **MS-TCN-RF** | Multi-Scale RF + Œî-Features | Capturing long/short-term patterns, robust to irregular sampling | Complex structure, high computational cost |

## üö® Troubleshooting

### When Confusion Matrix Shows Only One Color
- Possibility of predictions being biased toward one class
- Check prediction/actual distribution in code
- Check data imbalance

### Memory Insufficient Error
- Reduce `batch_size`
- Reduce `fixed_len`
- Check GPU memory

### Checkpoint Load Failure
- Check file path
- Check model structure compatibility

### TCN Model Training Considerations
- **TCN**: Adjust kernel_size and num_channels for performance improvement
- **Attention TCN**: Optimize attention effects by adjusting num_heads
- **TCN-Transformer**: Optimize transformer performance by adjusting num_layers and num_heads
- **Graph TCN**: Graph structure definition may be required
- **MS-TCN-RF**: 
  - `--ms_use_delta_features`: Delta features usage (default: True)
  - `--ms_use_deformable`: Deformable convolution usage (default: True)
  - `--ms_rf_branches`: RF branch ratio setting (default: "1/4,1,4")
  - `--tcn_channels`: Adjust channel count to control model capacity

### Loss Function Selection Guide
- **Cross Entropy**: Suitable for basic classification
- **Triplet Loss**: Effective for learning vessel similarities
- **Contrastive Loss**: Useful for improving embedding space quality
- **Combined Loss**: Effective for complex pattern learning

## üìù License

This project is created for educational and research purposes.

## ü§ù Contributing

Bug reports and feature suggestions are always welcome!

---

**Note**: This system is developed for research purposes related to maritime traffic safety and vessel tracking.

---

# üö¢ AIS Track Analysis System (ÌïúÍµ≠Ïñ¥ Î≤ÑÏ†Ñ)

AIS(Automatic Identification System) Îç∞Ïù¥ÌÑ∞Î•º ÌôúÏö©Ìïú ÏÑ†Î∞ï Ï∂îÏ†Å Î∞è Î∂ÑÏÑù ÏãúÏä§ÌÖúÏûÖÎãàÎã§.  
CNN-LSTM, Ïò§Î¶¨ÏßÄÎÑê LSTM, VQ-LSTM, TCN Í∏∞Î∞ò ÏÑ†Î∞ï Î∂ÑÎ•òÏôÄ VAE Í∏∞Î∞ò Ïù¥ÏÉÅ ÌÉêÏßÄ Í∏∞Îä•ÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§.

## üìã ÌîÑÎ°úÏ†ùÌä∏ Í∞úÏöî

### üéØ Ï£ºÏöî Í∏∞Îä•
- **ÏÑ†Î∞ï Î∂ÑÎ•ò (Classification)**: CNN-LSTM, TCNÏùÑ ÏÇ¨Ïö©Ìïú MMSIÎ≥Ñ ÏÑ†Î∞ï ÏãùÎ≥Ñ
- **Ïù¥ÏÉÅ ÌÉêÏßÄ (Anomaly Detection)**: VAEÎ•º ÏÇ¨Ïö©Ìïú ÎπÑÏ†ïÏÉÅ ÏÑ†Î∞ï ÌñâÎèô ÌÉêÏßÄ
- **Îã§ÏñëÌïú ÏÜêÏã§ Ìï®Ïàò**: Cross Entropy, Triplet Loss, Contrastive Loss, Combined Loss ÏßÄÏõê
- **ÏãúÍ∞ÅÌôî**: Confusion Matrix, t-SNE ÏûÑÎ≤†Îî©, Ïû¨Íµ¨ÏÑ± Ïò§Ï∞® Î∂ÑÌè¨ Îì±

### üèóÔ∏è ÏïÑÌÇ§ÌÖçÏ≤ò
- **CNN-LSTM**: ÏãúÍ≥ÑÏó¥ AIS Îç∞Ïù¥ÌÑ∞Ïùò Í≥µÍ∞ÑÏ†Å/ÏãúÍ∞ÑÏ†Å Ìå®ÌÑ¥ ÌïôÏäµ
- **TCN (Temporal Convolutional Network)**: Dilated convolution Í∏∞Î∞ò ÏãúÍ≥ÑÏó¥ Î™®Îç∏ÎßÅ
- **Dilated Residual TCN**: Layer NormalizationÏù¥ Ï∂îÍ∞ÄÎêú Í∞úÏÑ†Îêú TCN
- **Attention TCN**: Multi-head AttentionÏù¥ Í≤∞Ìï©Îêú TCN
- **TCN-Transformer**: TCN + Transformer Hybrid Î™®Îç∏
- **Graph TCN**: Graph ConvolutionÏù¥ Í≤∞Ìï©Îêú TCN
- **MS-TCN-RF**: Multi-Scale TCN with Receptive Field Search (Ïû•¬∑Îã®Í∏∞ Ìå®ÌÑ¥ ÎèôÏãú Ìè¨Ï∞©)
- **VAE (Variational AutoEncoder)**: Ï†ïÏÉÅ Ìå®ÌÑ¥ ÌïôÏäµ ÌõÑ Ïù¥ÏÉÅ ÌÉêÏßÄ
- **Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨**: MinMaxScaler Ï†ïÍ∑úÌôî, ÏãúÌÄÄÏä§ ÏÉùÏÑ±

## üöÄ ÏÑ§Ïπò Î∞è Ïã§Ìñâ

### 1. ÌôòÍ≤Ω ÏÑ§Ï†ï
```bash
# Í∞ÄÏÉÅÌôòÍ≤Ω ÏÉùÏÑ±
python -m venv ais_tracking_env

# Í∞ÄÏÉÅÌôòÍ≤Ω ÌôúÏÑ±Ìôî (Windows)
.\ais_tracking_env\Scripts\Activate.ps1

# Í∞ÄÏÉÅÌôòÍ≤Ω ÌôúÏÑ±Ìôî (Linux/Mac)
source ais_tracking_env/bin/activate

# ÏùòÏ°¥ÏÑ± ÏÑ§Ïπò
pip install -r requirements.txt
```

### 2. Ïã§Ìñâ Î∞©Î≤ï

#### Í∏∞Î≥∏ Ïã§Ìñâ (CNN-LSTM Î∂ÑÎ•ò)
```bash
python main_unified.py --csv_path your_data.csv
```

#### Îã§Î•∏ Î™®Îç∏Î°ú Î∂ÑÎ•ò
```bash
# TCN (Í∏∞Î≥∏)
python main_unified.py --model_type tcn --csv_path your_data.csv

# Dilated Residual TCN (Í∞úÏÑ†Îêú Î≤ÑÏ†Ñ)
python main_unified.py --model_type dilated_residual_tcn --csv_path your_data.csv

# Attention TCN
python main_unified.py --model_type attention_tcn --csv_path your_data.csv

# TCN-Transformer Hybrid
python main_unified.py --model_type tcn_transformer --csv_path your_data.csv

# Graph TCN
python main_unified.py --model_type graph_tcn --csv_path your_data.csv

# MS-TCN-RF (Multi-Scale TCN with Receptive Field Search)
python main_unified.py --model_type ms_tcn_rf --csv_path your_data.csv

# MS-TCN-RF Ïª§Ïä§ÌÑ∞ÎßàÏù¥Ïßï
python main_unified.py --model_type ms_tcn_rf --ms_use_delta_features --ms_use_deformable --ms_rf_branches "0.25,1,2,4" --csv_path your_data.csv
```

#### Îã§ÏñëÌïú ÏÜêÏã§ Ìï®Ïàò ÏÇ¨Ïö©
```bash
# Cross Entropy (Í∏∞Î≥∏)
python main_unified.py --loss_type cross_entropy --csv_path your_data.csv

# Triplet Loss
python main_unified.py --loss_type triplet --triplet_margin 1.5 --csv_path your_data.csv

# Contrastive Loss
python main_unified.py --loss_type contrastive --contrastive_temperature 0.05 --csv_path your_data.csv

# Combined Loss (Cross Entropy + Triplet/Contrastive)
python main_unified.py --loss_type combined --combined_weight 0.7 --csv_path your_data.csv
```

#### VAE Ïù¥ÏÉÅ ÌÉêÏßÄ
```bash
python main_unified.py --mode anomaly --csv_path your_data.csv
```

#### Ï≤¥ÌÅ¨Ìè¨Ïù∏Ìä∏Í∞Ä ÏûàÏùÑ Îïå ÌÖåÏä§Ìä∏Îßå Ïã§Ìñâ
```bash
python main_unified.py --test_only
```

## üìä ÏÇ¨Ïö©Î≤ï

### Î™ÖÎ†πÌñâ ÏòµÏÖò
```bash
python main_unified.py [OPTIONS]

Options:
  --mode {classification,anomaly}     Î∂ÑÏÑù Î™®Îìú (Í∏∞Î≥∏Í∞í: classification)
  --model_type {cnn_lstm,original_lstm,tcn,dilated_residual_tcn,attention_tcn,tcn_transformer,graph_tcn}  Î™®Îç∏ ÌÉÄÏûÖ (Í∏∞Î≥∏Í∞í: tcn)
  --csv_path PATH                     AIS Îç∞Ïù¥ÌÑ∞ CSV ÌååÏùº Í≤ΩÎ°ú
  --epochs INT                        ÌïôÏäµ ÏóêÌè¨ÌÅ¨ Ïàò (Í∏∞Î≥∏Í∞í: 80)
  --beta FLOAT                        VAE KL ÏÜêÏã§ Í∞ÄÏ§ëÏπò (Í∏∞Î≥∏Í∞í: 0.1)
  --lr FLOAT                          ÌïôÏäµÎ•† (Í∏∞Î≥∏Í∞í: 5e-3)
  --weight_decay FLOAT                Weight decay (Í∏∞Î≥∏Í∞í: 1e-4)
  --grad_clip FLOAT                   Gradient clipping value (Í∏∞Î≥∏Í∞í: 1.0)
  --label_smoothing FLOAT             Label smoothing for CE loss (Í∏∞Î≥∏Í∞í: 0.1)
  --scheduler_warmup_epochs INT       LR warmup epochs (Í∏∞Î≥∏Í∞í: 1)
  --min_lr_ratio FLOAT                ÏµúÏÜå ÌïôÏäµÎ•† ÎπÑÏú® (Í∏∞Î≥∏Í∞í: 0.4)
  --restart_period INT                cosine_restart Ï£ºÍ∏∞ (Í∏∞Î≥∏Í∞í: 10)
  --loss_type {cross_entropy,triplet,contrastive,combined}  ÏÜêÏã§ Ìï®Ïàò ÌÉÄÏûÖ (Í∏∞Î≥∏Í∞í: cross_entropy)
  --triplet_margin FLOAT              Triplet loss margin (Í∏∞Î≥∏Í∞í: 1.0)
  --contrastive_temperature FLOAT     Contrastive loss temperature (Í∏∞Î≥∏Í∞í: 0.07)
  --combined_weight FLOAT             Combined loss weight (Í∏∞Î≥∏Í∞í: 0.5)
  --device {auto,cuda,cpu}           Ïó∞ÏÇ∞ ÎîîÎ∞îÏù¥Ïä§ ÏÑ†ÌÉù (Í∏∞Î≥∏Í∞í: auto)
  --split_path PATH                   Î∂ÑÌï† Ïù∏Îç±Ïä§ ÌååÏùº Í≤ΩÎ°ú
  --test_only                         Ï≤¥ÌÅ¨Ìè¨Ïù∏Ìä∏Í∞Ä ÏûàÏúºÎ©¥ ÌïôÏäµ ÏóÜÏù¥ ÌÖåÏä§Ìä∏Îßå Ïã§Ìñâ
```

### ÏòàÏãú
```bash
# CNN-LSTM Î∂ÑÎ•ò (Í∏∞Î≥∏)
python main_unified.py --csv_path combined_output.csv --epochs 100

# TCN Î∂ÑÎ•ò (Í∏∞Î≥∏)
python main_unified.py --model_type tcn --csv_path combined_output.csv

# Attention TCN + Triplet Loss
python main_unified.py --model_type attention_tcn --loss_type triplet --triplet_margin 1.5 --csv_path combined_output.csv

# TCN-Transformer + Contrastive Loss
python main_unified.py --model_type tcn_transformer --loss_type contrastive --contrastive_temperature 0.05 --csv_path combined_output.csv

# Dilated Residual TCN + Combined Loss
python main_unified.py --model_type dilated_residual_tcn --loss_type combined --combined_weight 0.7 --csv_path combined_output.csv

# VAE Ïù¥ÏÉÅ ÌÉêÏßÄ
python main_unified.py --mode anomaly --csv_path combined_output.csv --epochs 50

# Ï†ÄÏû•Îêú Î™®Îç∏Î°ú ÌÖåÏä§Ìä∏Îßå Ïã§Ìñâ
python main_unified.py --test_only
```

## üìÅ Îç∞Ïù¥ÌÑ∞ ÌòïÏãù

### ÏûÖÎ†• CSV ÌååÏùº Íµ¨Ï°∞
```
MMSI,BaseDateTime,LAT,LON,SOG,COG,Heading,WDIR,WSPD,GST,PRES,ATMP,WTMP,...
```

### ÌïÑÏàò Ïª¨Îüº
- **Î∂ÑÎ•ò Î™®Îìú**: `LAT`, `LON`, `SOG`, `COG`, `Heading`
- **Ïù¥ÏÉÅÌÉêÏßÄ Î™®Îìú**: `LAT`, `LON`, `SOG`, `COG`, `Heading`, `WDIR`, `WSPD`, `GST`, `PRES`, `ATMP`, `WTMP`

## üß† Î™®Îç∏ ÏÑ§Î™Ö

### CNN-LSTM Î∂ÑÎ•ò Î™®Îç∏
- **Î™©Ï†Å**: MMSIÎ≥Ñ ÏÑ†Î∞ï Î∂ÑÎ•ò
- **ÏûÖÎ†•**: 5Í∞ú ÌäπÏÑ± (ÏúÑÎèÑ, Í≤ΩÎèÑ, ÏÜçÎèÑ, Î∞©Ìñ•, Ìó§Îî©)
- **Íµ¨Ï°∞**: CNN ‚Üí LSTM ‚Üí Î∂ÑÎ•òÍ∏∞
- **ÌäπÏßï**: Í≥µÍ∞ÑÏ†Å Ìå®ÌÑ¥Í≥º ÏãúÍ∞ÑÏ†Å ÏùòÏ°¥ÏÑ±ÏùÑ Î™®Îëê ÌïôÏäµ

### Ïò§Î¶¨ÏßÄÎÑê LSTM Î™®Îç∏
- **Î™©Ï†Å**: MMSIÎ≥Ñ ÏÑ†Î∞ï Î∂ÑÎ•ò
- **ÏûÖÎ†•**: 5Í∞ú ÌäπÏÑ± (ÏúÑÎèÑ, Í≤ΩÎèÑ, ÏÜçÎèÑ, Î∞©Ìñ•, Ìó§Îî©)
- **Íµ¨Ï°∞**: LSTM ‚Üí Î∂ÑÎ•òÍ∏∞
- **ÌäπÏßï**: ÏàúÏàò LSTMÏúºÎ°ú ÏãúÍ≥ÑÏó¥ Ìå®ÌÑ¥ ÌïôÏäµ

### VQ-LSTM Î™®Îç∏
- **Î™©Ï†Å**: MMSIÎ≥Ñ ÏÑ†Î∞ï Î∂ÑÎ•ò
- **ÏûÖÎ†•**: 5Í∞ú ÌäπÏÑ± (ÏúÑÎèÑ, Í≤ΩÎèÑ, ÏÜçÎèÑ, Î∞©Ìñ•, Ìó§Îî©)
- **Íµ¨Ï°∞**: LSTM ‚Üí Vector Quantizer ‚Üí Î∂ÑÎ•òÍ∏∞
- **ÌäπÏßï**: Vector QuantizationÏúºÎ°ú Îçî Ìö®Ïú®Ï†ÅÏù∏ ÏûÑÎ≤†Îî© ÌïôÏäµ

### VQ Bottleneck LSTM Î™®Îç∏
- **Î™©Ï†Å**: MMSIÎ≥Ñ ÏÑ†Î∞ï Î∂ÑÎ•ò
- **ÏûÖÎ†•**: 5Í∞ú ÌäπÏÑ± (ÏúÑÎèÑ, Í≤ΩÎèÑ, ÏÜçÎèÑ, Î∞©Ìñ•, Ìó§Îî©)
- **Íµ¨Ï°∞**: CNN ‚Üí VQ Bottleneck ‚Üí LSTM ‚Üí Î∂ÑÎ•òÍ∏∞
- **ÌäπÏßï**: Semantic abstractionÏùÑ ÌÜµÌïú Ï†ïÎ≥¥ ÏïïÏ∂ï Î∞è Ïû°Ïùå Ï†úÍ±∞

### Dual Stream LSTM Î™®Îç∏
- **Î™©Ï†Å**: MMSIÎ≥Ñ ÏÑ†Î∞ï Î∂ÑÎ•ò
- **ÏûÖÎ†•**: 5Í∞ú ÌäπÏÑ± (ÏúÑÎèÑ, Í≤ΩÎèÑ, ÏÜçÎèÑ, Î∞©Ìñ•, Ìó§Îî©)
- **Íµ¨Ï°∞**: CNN-LSTM (Stream A) + VQ-LSTM (Stream B) ‚Üí Feature Fusion ‚Üí Î∂ÑÎ•òÍ∏∞
- **ÌäπÏßï**: Ïó∞ÏÜçÏ†Å ÎèôÏó≠ÌïôÍ≥º Ïù¥ÏÇ∞Ï†Å ÏùòÎØ∏Î°†Ïùò Î≥¥ÏôÑÏ†Å ÌïôÏäµ

### VAE Ïù¥ÏÉÅ ÌÉêÏßÄ Î™®Îç∏
- **Î™©Ï†Å**: ÎπÑÏ†ïÏÉÅ ÏÑ†Î∞ï ÌñâÎèô ÌÉêÏßÄ
- **ÏûÖÎ†•**: 11Í∞ú ÌäπÏÑ± (Í∏∞ÏÉÅ Îç∞Ïù¥ÌÑ∞ Ìè¨Ìï®)
- **Íµ¨Ï°∞**: Ïù∏ÏΩîÎçî ‚Üí Ïû†Ïû¨Í≥µÍ∞Ñ ‚Üí ÎîîÏΩîÎçî
- **ÏõêÎ¶¨**: Ï†ïÏÉÅ Ìå®ÌÑ¥ ÌïôÏäµ ÌõÑ Ïû¨Íµ¨ÏÑ± Ïò§Ï∞®Î°ú Ïù¥ÏÉÅ ÌÉêÏßÄ

### TCN (Temporal Convolutional Network) Î™®Îç∏
- **Î™©Ï†Å**: MMSIÎ≥Ñ ÏÑ†Î∞ï Î∂ÑÎ•ò
- **ÏûÖÎ†•**: 5Í∞ú ÌäπÏÑ± (ÏúÑÎèÑ, Í≤ΩÎèÑ, ÏÜçÎèÑ, Î∞©Ìñ•, Ìó§Îî©)
- **Íµ¨Ï°∞**: Dilated Convolution ‚Üí Global Average Pooling ‚Üí Î∂ÑÎ•òÍ∏∞
- **ÌäπÏßï**: Î≥ëÎ†¨ Ï≤òÎ¶¨ Í∞ÄÎä•, Í∏¥ ÏãúÌÄÄÏä§ Ï≤òÎ¶¨Ïóê Ìö®Ïú®Ï†Å

### Dilated Residual TCN Î™®Îç∏
- **Î™©Ï†Å**: MMSIÎ≥Ñ ÏÑ†Î∞ï Î∂ÑÎ•ò
- **ÏûÖÎ†•**: 5Í∞ú ÌäπÏÑ± (ÏúÑÎèÑ, Í≤ΩÎèÑ, ÏÜçÎèÑ, Î∞©Ìñ•, Ìó§Îî©)
- **Íµ¨Ï°∞**: Dilated Residual Blocks ‚Üí Global Average Pooling ‚Üí Î∂ÑÎ•òÍ∏∞
- **ÌäπÏßï**: Layer NormalizationÏúºÎ°ú ÏïàÏ†ïÏÑ± Ìñ•ÏÉÅ, Residual connectionÏúºÎ°ú ÍπäÏùÄ ÎÑ§Ìä∏ÏõåÌÅ¨ ÌïôÏäµ

### Attention TCN Î™®Îç∏
- **Î™©Ï†Å**: MMSIÎ≥Ñ ÏÑ†Î∞ï Î∂ÑÎ•ò
- **ÏûÖÎ†•**: 5Í∞ú ÌäπÏÑ± (ÏúÑÎèÑ, Í≤ΩÎèÑ, ÏÜçÎèÑ, Î∞©Ìñ•, Ìó§Îî©)
- **Íµ¨Ï°∞**: TCN ‚Üí Multi-head Attention ‚Üí Global Average Pooling ‚Üí Î∂ÑÎ•òÍ∏∞
- **ÌäπÏßï**: Ï§ëÏöîÌïú ÏãúÏ†êÏóê ÏßëÏ§ëÌïòÏó¨ Îçî Ï†ïÌôïÌïú Î∂ÑÎ•ò

### TCN-Transformer Hybrid Î™®Îç∏
- **Î™©Ï†Å**: MMSIÎ≥Ñ ÏÑ†Î∞ï Î∂ÑÎ•ò
- **ÏûÖÎ†•**: 5Í∞ú ÌäπÏÑ± (ÏúÑÎèÑ, Í≤ΩÎèÑ, ÏÜçÎèÑ, Î∞©Ìñ•, Ìó§Îî©)
- **Íµ¨Ï°∞**: TCN Encoder ‚Üí Transformer Encoder ‚Üí Global Average Pooling ‚Üí Î∂ÑÎ•òÍ∏∞
- **ÌäπÏßï**: Ïû•Í±∞Î¶¨ ÏùòÏ°¥ÏÑ±Í≥º AttentionÏùÑ Í≤∞Ìï©Ìïú Í∞ïÎ†•Ìïú Î™®Îç∏

### Graph TCN Î™®Îç∏
- **Î™©Ï†Å**: MMSIÎ≥Ñ ÏÑ†Î∞ï Î∂ÑÎ•ò
- **ÏûÖÎ†•**: 5Í∞ú ÌäπÏÑ± (ÏúÑÎèÑ, Í≤ΩÎèÑ, ÏÜçÎèÑ, Î∞©Ìñ•, Ìó§Îî©)
- **Íµ¨Ï°∞**: TCN ‚Üí Graph Convolution ‚Üí Î∂ÑÎ•òÍ∏∞
- **ÌäπÏßï**: ÏÑ†Î∞ïÍ∞Ñ Í¥ÄÍ≥ÑÎ•º Î™®Îç∏ÎßÅÌïòÏó¨ Îçî Ï†ïÌôïÌïú Î∂ÑÎ•ò

### MS-TCN-RF (Multi-Scale TCN with Receptive Field Search) Î™®Îç∏
- **Î™©Ï†Å**: MMSIÎ≥Ñ ÏÑ†Î∞ï Î∂ÑÎ•ò (Ïû•¬∑Îã®Í∏∞ Ìå®ÌÑ¥ ÎèôÏãú Ìè¨Ï∞©)
- **ÏûÖÎ†•**: 5Í∞ú ÌäπÏÑ± (ÏúÑÎèÑ, Í≤ΩÎèÑ, ÏÜçÎèÑ, Î∞©Ìñ•, Ìó§Îî©) + ŒîÌäπÏÑ± + ÏãúÍ∞ÑÍ∞ÑÍ≤©
- **Íµ¨Ï°∞**: 
  - **Multi-Scale RF Î∏åÎûúÏπò**: ÏÑúÎ°ú Îã§Î•∏ RFÎ•º Î≥ëÎ†¨Î°ú Ï≤òÎ¶¨ (RF‚âà0.25√ó¬∑1√ó¬∑4√ó)
  - **Í≤åÏù¥ÌåÖ/Ïñ¥ÌÖêÏÖò**: Î∏åÎûúÏπòÎ≥Ñ Í∞ÄÏ§ëÌï©ÏúºÎ°ú ÏµúÏ†Å Ï°∞Ìï© ÌïôÏäµ
  - **Œî-Feature Ïù∏ÏΩîÎî©**: COG/SOG Ï†àÎåÄÍ∞í + ŒîCOG, ŒîSOG, ŒîLat, ŒîLon, Œît
  - **Deformable Temporal Convolution**: ÏãúÍ∞ÑÏ∂ïÏóêÏÑú ÏÉòÌîå ÏúÑÏπò Ïò§ÌîÑÏÖã ÌïôÏäµ
  - **Segment-Aware Pooling**: Ï†ïÎ∞ï/Í∞ÄÏÜç/ÏÑ†Ìöå ÏÑ∏Í∑∏Î®ºÌä∏Î≥Ñ ÌÜµÍ≥Ñ + Ïñ¥ÌÖêÏÖò ÌíÄÎßÅ
- **ÌäπÏßï**: 
  - Î∂àÍ∑úÏπô ÏÉòÌîåÎßÅÏóê Í∞ïÍ±¥Ìïú Dual-Stream Ï≤òÎ¶¨
  - ÏÑ†Î∞ïÏùò Î∂àÍ∑úÏπôÌïú Í∞ÄÍ∞êÏÜç/ÌöåÏ†Ñ Íµ¨Í∞Ñ Ï†ïÎ†¨
  - ÌñâÎèô ÏÉÅÌÉú Ïù∏Ïãù Í∏∞Î∞ò ÏûÑÎ≤†Îî©

### ÏÜêÏã§ Ìï®ÏàòÎì§
- **Cross Entropy**: Í∏∞Î≥∏ Î∂ÑÎ•ò ÏÜêÏã§ Ìï®Ïàò
- **Triplet Loss**: Í∞ôÏùÄ ÏÑ†Î∞ïÏùÄ Í∞ÄÍπùÍ≤å, Îã§Î•∏ ÏÑ†Î∞ïÏùÄ Î©ÄÍ≤å ÌïôÏäµ
- **Contrastive Loss**: Ïú†ÏÇ¨ÎèÑ Í∏∞Î∞ò ÌïôÏäµÏúºÎ°ú Îçî ÎÇòÏùÄ ÏûÑÎ≤†Îî© Í≥µÍ∞Ñ ÏÉùÏÑ±
- **Combined Loss**: Cross EntropyÏôÄ Triplet/Contrastive LossÎ•º Ï°∞Ìï©

## üìà Ï∂úÎ†• Í≤∞Í≥º

### Î∂ÑÎ•ò Î™®Îìú
- **ÏÑ±Îä• ÏßÄÌëú**: Accuracy, Precision, Recall, F1-score
- **ÏãúÍ∞ÅÌôî**: 
  - Confusion Matrix (ÏõêÎ≥∏/Ï†ïÍ∑úÌôî)
  - t-SNE ÏûÑÎ≤†Îî© Í≥µÍ∞Ñ
- **Ï†ÄÏû• ÌååÏùº**: `checkpoints/{model_type}_classifier.pt`

### Ïù¥ÏÉÅÌÉêÏßÄ Î™®Îìú
- **ÏÑ±Îä• ÏßÄÌëú**: Ïù¥ÏÉÅ ÌÉêÏßÄ Ï†ïÌôïÎèÑ, ÏûÑÍ≥ÑÍ∞í
- **ÏãúÍ∞ÅÌôî**:
  - Ïû¨Íµ¨ÏÑ± Ïò§Ï∞® ÌûàÏä§ÌÜ†Í∑∏Îû®
  - Ïû†Ïû¨ Í≥µÍ∞Ñ t-SNE
- **Ï†ÄÏû• ÌååÏùº**: `checkpoints/vae_final.pt`

## üîß Ï£ºÏöî ÌååÏùº

### ÌïµÏã¨ ÌååÏùº
- `main_unified.py`: Î©îÏù∏ Ïã§Ìñâ ÌååÏùº
- `cnn_lstm_model.py`: CNN-LSTM Î∂ÑÎ•ò Î™®Îç∏
- `lstm_models.py`: Ïò§Î¶¨ÏßÄÎÑê LSTM, VQ-LSTM Î™®Îç∏
- `va_vae_model.py`: VAE Ïù¥ÏÉÅ ÌÉêÏßÄ Î™®Îç∏
- `requirements.txt`: ÏùòÏ°¥ÏÑ± Ìå®ÌÇ§ÏßÄ Î™©Î°ù

### Îç∞Ïù¥ÌÑ∞ ÌååÏùº
- `combined_output.csv`: AIS Îç∞Ïù¥ÌÑ∞
- `split_indices.pkl`: Îç∞Ïù¥ÌÑ∞ Î∂ÑÌï† Ïù∏Îç±Ïä§

### Ï∂úÎ†• ÌååÏùº
- `checkpoints/`: ÌïôÏäµÎêú Î™®Îç∏ Ï≤¥ÌÅ¨Ìè¨Ïù∏Ìä∏
- `logs/`: ÌïôÏäµ Î°úÍ∑∏
- `*.png`: ÏãúÍ∞ÅÌôî Í≤∞Í≥º

## üéØ Î™®Îç∏ ÎèôÏûë ÏõêÎ¶¨

### MS-TCN-RF Î™®Îç∏Ïùò ÌïµÏã¨ ÏïÑÏù¥ÎîîÏñ¥
1. **Multi-Scale RF Search**: ÏÑúÎ°ú Îã§Î•∏ ÏàòÏö©Ïó≠ÏùÑ Î≥ëÎ†¨Î°ú Ï≤òÎ¶¨ÌïòÏó¨ Ïû•¬∑Îã®Í∏∞ Ìå®ÌÑ¥ ÎèôÏãú Ìè¨Ï∞©
2. **Œî-Feature Ïù∏ÏΩîÎî©**: Ï†àÎåÄÍ∞íÎøêÎßå ÏïÑÎãàÎùº Î≥ÄÌôîÎüâÍ≥º ÏãúÍ∞ÑÍ∞ÑÍ≤©ÏùÑ Î≥ÑÎèÑ Ïä§Ìä∏Î¶ºÏúºÎ°ú Ï≤òÎ¶¨
3. **Deformable Temporal Convolution**: ÏãúÍ∞ÑÏ∂ïÏóêÏÑú ÏÉòÌîå ÏúÑÏπò Ïò§ÌîÑÏÖãÏùÑ ÌïôÏäµÌïòÏó¨ Î∂àÍ∑úÏπôÌïú Ìå®ÌÑ¥ Ï†ïÎ†¨
4. **Segment-Aware Pooling**: Ï†ïÎ∞ï/Í∞ÄÏÜç/ÏÑ†Ìöå Îì± ÌñâÎèô ÏÉÅÌÉúÎ•º Ïù∏ÏãùÌïòÏó¨ ÏÑ∏Í∑∏Î®ºÌä∏Î≥Ñ ÌÜµÍ≥Ñ + Ïñ¥ÌÖêÏÖò ÌíÄÎßÅ

### Î∂ÑÎ•ò Î™®Îç∏Îì§
1. **Îç∞Ïù¥ÌÑ∞ Ï†ÑÏ≤òÎ¶¨**: MinMaxScalerÎ°ú Ï†ïÍ∑úÌôî
2. **ÏãúÌÄÄÏä§ ÏÉùÏÑ±**: 50Í∞ú Ìè¨Ïù∏Ìä∏ Í≥†Ï†ï Í∏∏Ïù¥ ÏãúÌÄÄÏä§
3. **Î™®Îç∏Î≥Ñ Ï≤òÎ¶¨**:
   - **CNN-LSTM**: CNN ‚Üí LSTM ‚Üí Î∂ÑÎ•ò
   - **Ïò§Î¶¨ÏßÄÎÑê LSTM**: LSTM ‚Üí Î∂ÑÎ•ò
   - **VQ-LSTM**: LSTM ‚Üí Vector Quantizer ‚Üí Î∂ÑÎ•ò
4. **Î∂ÑÎ•ò**: MMSIÎ≥Ñ ÏÑ†Î∞ï ÏòàÏ∏°

### Ïù¥ÏÉÅÌÉêÏßÄ (VAE)
1. **Ï†ïÏÉÅ Ìå®ÌÑ¥ ÌïôÏäµ**: ÎåÄÎ∂ÄÎ∂ÑÏùò Îç∞Ïù¥ÌÑ∞Î°ú Ï†ïÏÉÅ ÌñâÎèô ÌïôÏäµ
2. **Ïû¨Íµ¨ÏÑ±**: ÏûÖÎ†• ‚Üí Ïû†Ïû¨Í≥µÍ∞Ñ ‚Üí Î≥µÏõê
3. **Ïò§Ï∞® Í≥ÑÏÇ∞**: ÏûÖÎ†•Í≥º Î≥µÏõê Í≤∞Í≥ºÏùò Ï∞®Ïù¥
4. **Ïù¥ÏÉÅ ÌåêÏ†ï**: ÏûÑÍ≥ÑÍ∞í(95%) Ï¥àÍ≥º Ïãú Ïù¥ÏÉÅÏúºÎ°ú ÌÉêÏßÄ

## üîç Î™®Îç∏ ÎπÑÍµê

| Î™®Îç∏ | ÌäπÏßï | Ïû•Ï†ê | Îã®Ï†ê |
|------|------|------|------|
| **CNN-LSTM** | Í≥µÍ∞ÑÏ†Å+ÏãúÍ∞ÑÏ†Å Ìå®ÌÑ¥ | Î≥µÏû°Ìïú Ìå®ÌÑ¥ ÌïôÏäµ | ÌååÎùºÎØ∏ÌÑ∞ Ïàò ÎßéÏùå |
| **Ïò§Î¶¨ÏßÄÎÑê LSTM** | ÏàúÏàò ÏãúÍ≥ÑÏó¥ | Îã®ÏàúÌïòÍ≥† Îπ†Î¶Ñ | Í≥µÍ∞ÑÏ†Å Ìå®ÌÑ¥ Ï†úÌïúÏ†Å |
| **VQ-LSTM** | ÏñëÏûêÌôîÎêú ÏûÑÎ≤†Îî© | Ìö®Ïú®Ï†ÅÏù∏ ÌëúÌòÑ | ÌïôÏäµ Î≥µÏû°ÎèÑ ÎÜíÏùå |
| **VQ Bottleneck LSTM** | Semantic abstraction | Ïû°Ïùå Ï†úÍ±∞, Ìï¥ÏÑù Í∞ÄÎä• | Ï†ïÎ≥¥ ÏÜêÏã§ Í∞ÄÎä•ÏÑ± |
| **Dual Stream LSTM** | Î≥¥ÏôÑÏ†Å ÌäπÏÑ± ÌïôÏäµ | Í∞ïÍ±¥Ìïú ÌïôÏäµ | Î≥µÏû°Ìïú Íµ¨Ï°∞ |
| **TCN** | Dilated convolution | Î≥ëÎ†¨ Ï≤òÎ¶¨, Í∏¥ ÏãúÌÄÄÏä§ | Î°úÏª¨ Ìå®ÌÑ¥ Ï†úÌïúÏ†Å |
| **Dilated Residual TCN** | LayerNorm + Residual | ÏïàÏ†ïÏ†Å ÌïôÏäµ, ÍπäÏùÄ ÎÑ§Ìä∏ÏõåÌÅ¨ | ÌååÎùºÎØ∏ÌÑ∞ Ïàò Ï¶ùÍ∞Ä |
| **Attention TCN** | TCN + Attention | Ï§ëÏöîÌïú ÏãúÏ†ê ÏßëÏ§ë | Í≥ÑÏÇ∞ Î≥µÏû°ÎèÑ Ï¶ùÍ∞Ä |
| **TCN-Transformer** | TCN + Transformer | Ïû•Í±∞Î¶¨ ÏùòÏ°¥ÏÑ± | Îß§Ïö∞ Î≥µÏû°Ìïú Íµ¨Ï°∞ |
| **Graph TCN** | TCN + Graph Conv | ÏÑ†Î∞ïÍ∞Ñ Í¥ÄÍ≥Ñ Î™®Îç∏ÎßÅ | Í∑∏ÎûòÌîÑ Íµ¨Ï°∞ ÌïÑÏöî |
| **MS-TCN-RF** | Multi-Scale RF + Œî-Features | Ïû•¬∑Îã®Í∏∞ Ìå®ÌÑ¥ ÎèôÏãú Ìè¨Ï∞©, Î∂àÍ∑úÏπô ÏÉòÌîåÎßÅ Í∞ïÍ±¥ | Î≥µÏû°Ìïú Íµ¨Ï°∞, Í≥ÑÏÇ∞ ÎπÑÏö© ÎÜíÏùå |

## üö® Î¨∏Ï†ú Ìï¥Í≤∞

### Confusion MatrixÍ∞Ä Ìïú ÏÉâÏÉÅÎßå Î≥¥Ïùº Îïå
- ÏòàÏ∏°Ïù¥ Ìïú ÌÅ¥ÎûòÏä§Î°ú Ïè†Î†∏ÏùÑ Í∞ÄÎä•ÏÑ±
- ÏΩîÎìúÏóêÏÑú ÏòàÏ∏°/Ïã§Ï†ú Î∂ÑÌè¨ ÌôïÏù∏
- Îç∞Ïù¥ÌÑ∞ Î∂àÍ∑†Ìòï Ï†êÍ≤Ä

### Î©îÎ™®Î¶¨ Î∂ÄÏ°± Ïò§Î•ò
- `batch_size` Ï§ÑÏù¥Í∏∞
- `fixed_len` Ï§ÑÏù¥Í∏∞
- GPU Î©îÎ™®Î¶¨ ÌôïÏù∏

### Ï≤¥ÌÅ¨Ìè¨Ïù∏Ìä∏ Î°úÎìú Ïã§Ìå®
- ÌååÏùº Í≤ΩÎ°ú ÌôïÏù∏
- Î™®Îç∏ Íµ¨Ï°∞ ÏùºÏπò Ïó¨Î∂Ä ÌôïÏù∏

### VQ-LSTM ÌïôÏäµ Ïãú Ï£ºÏùòÏÇ¨Ìï≠
- commitment_cost Ï°∞Ï†ï ÌïÑÏöîÌï† Ïàò ÏûàÏùå
- perplexity Í∞í Î™®ÎãàÌÑ∞ÎßÅ
- VQ ÏÜêÏã§Í≥º Î∂ÑÎ•ò ÏÜêÏã§ Í∑†Ìòï Ï°∞Ï†ï

### TCN Î™®Îç∏ ÌïôÏäµ Ïãú Ï£ºÏùòÏÇ¨Ìï≠
- **TCN**: kernel_sizeÏôÄ num_channels Ï°∞Ï†ïÏúºÎ°ú ÏÑ±Îä• Ìñ•ÏÉÅ
- **Attention TCN**: num_heads Ï°∞Ï†ïÏúºÎ°ú attention Ìö®Í≥º ÏµúÏ†ÅÌôî
- **TCN-Transformer**: num_layersÏôÄ num_heads Ï°∞Ï†ïÏúºÎ°ú transformer ÏÑ±Îä• ÏµúÏ†ÅÌôî
- **Graph TCN**: Í∑∏ÎûòÌîÑ Íµ¨Ï°∞ Ï†ïÏùòÍ∞Ä ÌïÑÏöîÌï† Ïàò ÏûàÏùå
- **MS-TCN-RF**: 
  - `--ms_use_delta_features`: Delta features ÏÇ¨Ïö© Ïó¨Î∂Ä (Í∏∞Î≥∏Í∞í: True)
  - `--ms_use_deformable`: Deformable convolution ÏÇ¨Ïö© Ïó¨Î∂Ä (Í∏∞Î≥∏Í∞í: True)
  - `--ms_rf_branches`: RF Î∏åÎûúÏπò ÎπÑÏú® ÏÑ§Ï†ï (Í∏∞Î≥∏Í∞í: "1/4,1,4")
  - `--tcn_channels`: Ï±ÑÎÑê Ïàò Ï°∞Ï†ïÏúºÎ°ú Î™®Îç∏ Ïö©Îüâ Ï°∞Ï†à

### ÏÜêÏã§ Ìï®Ïàò ÏÑ†ÌÉù Í∞ÄÏù¥Îìú
- **Cross Entropy**: Í∏∞Î≥∏ Î∂ÑÎ•òÏóê Ï†ÅÌï©
- **Triplet Loss**: ÏÑ†Î∞ï Í∞Ñ Ïú†ÏÇ¨ÎèÑ ÌïôÏäµÏóê Ìö®Í≥ºÏ†Å
- **Contrastive Loss**: ÏûÑÎ≤†Îî© Í≥µÍ∞Ñ ÌíàÏßà Ìñ•ÏÉÅÏóê Ïú†Ïö©
- **Combined Loss**: Î≥µÏû°Ìïú Ìå®ÌÑ¥ ÌïôÏäµÏóê Ìö®Í≥ºÏ†Å

## üìù ÎùºÏù¥ÏÑºÏä§

Ïù¥ ÌîÑÎ°úÏ†ùÌä∏Îäî ÍµêÏú° Î∞è Ïó∞Íµ¨ Î™©Ï†ÅÏúºÎ°ú Ï†úÏûëÎêòÏóàÏäµÎãàÎã§.

## ü§ù Í∏∞Ïó¨

Î≤ÑÍ∑∏ Î¶¨Ìè¨Ìä∏ÎÇò Í∏∞Îä• Ï†úÏïàÏùÄ Ïñ∏Ï†úÎì† ÌôòÏòÅÌï©ÎãàÎã§!

---

**Ï∞∏Í≥†**: Ïù¥ ÏãúÏä§ÌÖúÏùÄ Ìï¥Ïñë ÍµêÌÜµ ÏïàÏ†ÑÍ≥º ÏÑ†Î∞ï Ï∂îÏ†ÅÏùÑ ÏúÑÌïú Ïó∞Íµ¨ Î™©Ï†ÅÏúºÎ°ú Í∞úÎ∞úÎêòÏóàÏäµÎãàÎã§. 
